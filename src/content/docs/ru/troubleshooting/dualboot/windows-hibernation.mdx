---
title: "Проблемы при переключении между Windows и Linux"
description: "Решение проблем с сетью, Bluetooth и файловой системой при dual-boot конфигурации"
sidebar:
  order: 1
---

import { Aside } from '@astrojs/starlight/components';

Если у вас установлены Windows и Linux на одном компьютере, вы наверняка сталкивались с неприятными проблемами при переключении между операционными системами.

## Типичные проблемы

При использовании dual-boot конфигурации пользователи регулярно сталкиваются со следующими проблемами:

- **Сбои сетевых подключений** — Ethernet и Wi-Fi перестают работать после переключения с Windows на Linux
- **Неработающий Bluetooth** — Bluetooth-адаптер не обнаруживается или не может подключиться к устройствам
- **Файловая система только для чтения** — Диски, используемые обеими системами, монтируются в режиме read-only и не позволяют записывать данные

<Aside type="caution" title="Почему это происходит?">
Причина всех этих проблем — **режим гибернации Windows**. Когда Windows переходит в режим гибернации (Fast Startup), она не полностью завершает работу, а сохраняет состояние системы на диск. Это приводит к блокировке аппаратных устройств и файловых систем, что вызывает конфликты при загрузке Linux.
</Aside>

## Автоматическое решение проблемы

Существует элегантное решение, которое автоматически отключает гибернацию при каждом выключении Windows. Это гарантирует, что при следующей загрузке Linux все устройства будут работать корректно.

### Шаг 1: Создание скрипта отключения гибернации

Создайте текстовый файл с именем `hibernate_off.bat` и добавьте в него следующую команду:

```batch
powercfg -h off
```

<Aside type="tip" title="Что делает эта команда?">
Команда `powercfg -h off` отключает файл гибернации (hiberfil.sys) и режим быстрого запуска (Fast Startup), освобождая все аппаратные ресурсы при выключении компьютера.
</Aside>

### Шаг 2: Размещение скрипта в системной директории

1. Откройте **Проводник Windows**
2. Скопируйте файл `hibernate_off.bat`
3. Перейдите по пути: `C:\Windows\System32\GroupPolicy\Machine\Scripts\Shutdown`
4. Вставьте файл в эту директорию

<Aside type="note">
Для доступа к этой папке потребуются права администратора. Если папка `Shutdown` не существует, создайте её вручную.
</Aside>

### Шаг 3: Настройка групповой политики

Теперь необходимо настроить Windows так, чтобы скрипт автоматически запускался при каждом выключении системы.

1. Нажмите комбинацию клавиш **Win + R**
2. В открывшемся окне "Выполнить" введите: `gpedit.msc`
3. Нажмите **OK**

![Окно "Выполнить" с командой gpedit.msc](https://media.geeksforgeeks.org/wp-content/uploads/20231224124334/Open-Group-Policy.jpg)

### Шаг 4: Добавление скрипта в политику выключения

В открывшемся редакторе локальной групповой политики:

1. Перейдите по следующему пути в левой панели:
   ```
   Конфигурация компьютера → Конфигурация Windows → Сценарии (вход/выход) → Завершение работы
   ```
   
   На английском:
   ```
   Computer Configuration → Windows Settings → Scripts (Startup/Shutdown) → Shutdown
   ```

2. Дважды щелкните на **Завершение работы** (Shutdown)

3. В открывшемся окне нажмите кнопку **Добавить**

4. Нажмите кнопку **Обзор** (Browse)

5. Найдите и выберите файл `hibernate_off.bat`, который вы разместили в папке `Shutdown`

6. Нажмите **OK** для подтверждения

7. Нажмите **Применить** и затем **OK** для сохранения изменений

<Aside type="tip" title="Проверка настройки">
После настройки в окне "Завершение работы" должен отображаться скрипт `hibernate_off.bat` в списке сценариев выключения.
</Aside>


## Результат

После выполнения всех шагов:

- Сетевые подключения работают стабильно
- Bluetooth-устройства подключаются без проблем
- Файловые системы монтируются с правами на запись
- Не нужно вручную отключать гибернацию каждый раз

<Aside type="caution" title="Важное замечание">
Отключение гибернации немного увеличит время загрузки Windows (на 2-5 секунд), так как система будет выполнять полное выключение вместо быстрого запуска. Однако это небольшая цена за стабильную работу dual-boot конфигурации.
</Aside>

